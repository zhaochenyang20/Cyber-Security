# TCP/IP 协议栈安全

## TCP/IP协议工作原理 P11

纵向横向传递 P11-19

## 链路层安全 P19

链路层功能 P20

ARP欺骗与污染 P21
1. 如何防御ARP P33

网络监听与嗅探 P34
1. 两面性 P36
2. 防御方法：洋葱路由 P40
> 洋葱路由网络的主要目的是保护用户的隐私和匿名性，使得在网络上进行监听和嗅探变得更加困难。通过在多个洋葱路由器之间进行多重加密的数据转发，洋葱路由网络可以有效地防止攻击者通过监听和嗅探获取用户的信息和通信内容。即使攻击者能够捕获到数据包，由于数据的多重加密，攻击者难以解密数据内容或者追踪数据包的发送者和接收者。

## 网络层安全 P43

网络层功能 P44

安全风险一: 源地址假冒攻击 P45
攻击者在发送数据包时伪造源IP地址，从而隐藏其真实身份或者导致网络流量被错误地发送到其他目标

安全风险二: IP分片攻击 P52
具体可以分为三种：
1. 拒绝服务攻击：攻击者发送大量的IP分片，使得目标主机在重组分片时耗尽资源，从而导致拒绝服务 P55
2. 污染攻击：原始报文被分片、传输过程中，攻击者伪造一些分片，注入到正常分片流中，篡改原始报文内容 P58
3. 安全策略逃逸：通过设置合理的分片偏移，逃逸防火墙的审查 P69
防御：P76

安全防御一: IPSec协议 P80
- AH P82
- ESP P83   
- 传输模式 P85
- 隧道模式 P85

安全防御二: 网络入侵检测系统IDS P89
从主要技术途径上区分，IDS主要分为两类
1. 基于特征匹配的IDS P89
2. 基于异常检测的IDS P90

路由协议安全: 
1. 域间路由安全 P95
2. 域内路由安全 P100
    - Fight-back安全机制
    - Periodic injection 攻击
    - Disguised LSA 攻击

## 传输层安全 P107

传输层主要负责提供不同主机应用程序进程之间的端到端的服务

拒绝服务攻击 P109
1. SYN Flooding P111
2. 利用 ICMP 重定向进行隐蔽 DoS 攻击 P114

TCP劫持攻击 P116
1. 基于challenge ACK侧信道漏洞的TCP连接劫持
2. 基于IPID侧信道漏洞的TCP连接劫持


TLS协议 P125

## 网络安全共性分析 P131

攻击者可以进行身份欺骗，伪装成网络通信的一端

攻击者可以进行推理猜测，成功构造出可被通信对端接受的数据报文 
